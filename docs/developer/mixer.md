---
sidebar_position: 4
---

# Mixer
Mixerは名前の通りミキサーのことで、rt-2023-botリポジトリの`core.mixer_pool`に実装されています。  
これは、簡単に複数の音声を再生するためのものです。  
`core.mixer_pool.MixerPool.acquire`でこのミキサーオブジェクトを取得してください。  
ミキサーオブジェクトの使用が終了した場合は、`MixerPool.release`で返却を行なってください。  
それと、ミキサーオブジェクトは`discord.AudioSource`を継承していますが、ミキサーオブジェクト自体を`discord.VoiceClient.play`に渡す必要はありません。(後述)  
なお、`MixerPool`のインスタンスはBotのインスタンスの`mixers`という属性で代入されます。

## `MixerPool.acquire`について
これを実行するとまだボイスチャンネルに接続していない場合は自動で接続が行われます。  
また、既に接続していて同じチャンネルで使われているミキサーオブジェクトが他のプログラムで使われている場合は、同じミキサーオブジェクトが返されます。  

## `MixerPool.release`について
この関数は`group`という引数を受け取ります。  
この引数には、ミキサーを使うコグの名前(`.__cog_name__`に代入されている)を使用してください。  
これは、ミキサーを使用している元を識別するためで、何に使うかは後述します。

## 再生方法
ミキサーオブジェクトの`play`メソッドを、`discord.AudioSource`を継承したクラスのインスタンス(再生する音源)を渡して実行すれば良いです。  
既に何かしら再生されている場合は、その既に再生されている音源と同時に再生されます。  
再生した音源の再生停止等のメソッドも実装されています。  
それは、軽いドキュメンテーションも書いてあるので、ソースコードから見てください。

## `Mixer.afters`について
これは、`Mixer`が返却された際に実行されるものです。  
後処理が必要な場合などに使ってください。  
この属性にあるものは、グループ名をキーとして、関数を値とする辞書です。  
グループ名は`MixerPool.release`実行時に渡すグループ名にしてください。  
さもなければ、設定した関数は実行されません。